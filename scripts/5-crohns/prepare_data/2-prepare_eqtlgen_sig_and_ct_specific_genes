library(tidyverse)

crohns_dir = "/g/data/fy54/analysis/tenk10k-causal/resources/crohns_case_study"

# get eqtlgen_mr_sig results 

eqtlgen_crohns_sig <- readRDS(paste0(crohns_dir, "/postprocess/eqtlgen_crohns_sig.RDS"))
x <- eqtlgen_crohns_sig %>% select(probeID) 
saveRDS(x, paste0(crohns_dir, "/crohns_relevant_gene_lists/eqtlgen_crohns_sig_genes.RDS"))

# get a list of cell type specific genes in the crohn's disease dataset 

# load objects
mr <- readRDS(paste0(crohns_dir, "/postprocess/tenk_crohns_sig.RDS"))

# get genes only significant in one cell type 
ct_spec_genes <- mr %>% 
  group_by(probeID) %>% 
  tally() %>% 
  filter(n == 1) %>% 
  pull(probeID)

saveRDS(ct_spec_genes, paste0(crohns_dir, "/crohns_relevant_gene_lists/tenk_crohns_sig_cell_type_specific_genes.RDS"))
